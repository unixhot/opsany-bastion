(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e8f2939e"],{"043d":function(e,t,a){"use strict";var s=a("bf96a"),r=a.n(s);r.a},"0c00":function(e,t,a){"use strict";t["a"]=[{width:800,height:600,key:1},{width:1024,height:768,key:2},{width:1280,height:720,key:3},{width:1280,height:800,key:4},{width:1280,height:1024,key:5},{width:1366,height:768,key:6},{width:1440,height:900,key:7},{width:1920,height:1080,key:8},{width:1920,height:1200,key:9},{width:2160,height:1440,key:10},{width:2560,height:1600,key:11},{width:2880,height:1800,key:12}]},"17b2":function(e,t,a){"use strict";var s=a("51a4"),r=a.n(s);r.a},"1da1":function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));a("d3b7");function s(e,t,a,s,r,o,i){try{var n=e[o](i),l=n.value}catch(d){return void a(d)}n.done?t(l):Promise.resolve(l).then(s,r)}function r(e){return function(){var t=this,a=arguments;return new Promise((function(r,o){var i=e.apply(t,a);function n(e){s(i,r,o,n,l,"next",e)}function l(e){s(i,r,o,n,l,"throw",e)}n(void 0)}))}}},"23ba":function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return n})),a.d(t,"e",(function(){return l}));var s=a("b775"),r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"credential-group/",method:"get",params:e})},o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"credential-group/",method:"post",data:e})},i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"credential-group/",method:"put",data:e})},n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"credential-group/",method:"delete",data:e})},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"group-credential/",method:"delete",data:e})}},2783:function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return n}));var s=a("b775"),r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"network-proxy/",method:"get",params:e})},o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"network-proxy/",method:"post",data:e})},i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"network-proxy/",method:"put",data:e})},n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"network-proxy/",method:"delete",data:e})}},"2b08":function(e,t,a){},4246:function(e,t,a){"use strict";a.d(t,"h",(function(){return r})),a.d(t,"a",(function(){return o})),a.d(t,"f",(function(){return i})),a.d(t,"d",(function(){return n})),a.d(t,"i",(function(){return l})),a.d(t,"b",(function(){return d})),a.d(t,"g",(function(){return c})),a.d(t,"e",(function(){return u})),a.d(t,"k",(function(){return h})),a.d(t,"j",(function(){return p})),a.d(t,"c",(function(){return m}));var s=a("b775"),r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"host/",method:"get",params:e})},o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"host/",method:"post",data:e})},i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"host/",method:"put",data:e})},n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"host/",method:"delete",data:e})},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"host-group/",method:"get",params:e})},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"host-group/",method:"post",data:e})},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"host-group/",method:"put",data:e})},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"host-group/",method:"delete",data:e})},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"host-credential/",method:"delete",data:e})},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"auth-host/",method:"get",params:e})},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"check-import/",method:"post",data:e})}},"4a44":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("ContentHeader",[a("div",{attrs:{slot:"docs"},slot:"docs"},[e._v(" 支持自定义主机分组，创建主机时可以直接创建和关联登录凭证，一个主机可以关联多个登录凭证。 ")])]),a("a-card",[a("div",{staticClass:"content"},[a("div",{staticClass:"content_left"},[e.showTree?a("a-tree",{attrs:{selectedKeys:e.selectedKeys,defaultExpandAll:"","show-line":!0,treeData:e.treeData},on:{select:e.treeSelect},scopedSlots:e._u([{key:"action",fn:function(t){return[a("span",{staticClass:"treetitle",attrs:{title:t.title}},[e._v(e._s(t.title)+" ("+e._s(t.count||0)+")")]),1!=t.key?a("a-dropdown",{staticClass:"dropdown",attrs:{trigger:["click"]},nativeOn:{click:function(e){e.stopPropagation()}}},[a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},["all"!=t.key&&e.$store.state.btnAuth.btnAuth.bastion_host_group_update?a("a-menu-item",{key:"1",on:{click:function(a){return e.$refs.AddGroup.show(t,"edit")}}},[a("a-icon",{attrs:{type:"edit"}}),e._v("编辑 ")],1):e._e(),(t.layer<5||"all"==t.key)&&e.$store.state.btnAuth.btnAuth.bastion_host_group_create?a("a-menu-item",{key:"2",on:{click:function(a){return e.$refs.AddGroup.show(t,"add")}}},[a("a-icon",{attrs:{type:"folder"}}),e._v("添加子文件夹 ")],1):e._e(),"all"!=t.key&&e.$store.state.btnAuth.btnAuth.bastion_host_group_delete?a("a-menu-item",{key:"3",on:{click:function(a){return e.deleteGroup(t)}}},[a("a-icon",{attrs:{type:"delete"}}),e._v("删除 ")],1):e._e()],1),a("a-button",{attrs:{type:"link",icon:"more"}})],1):e._e()]}}],null,!1,1258608856)}):a("a-spin")],1),a("div",{staticClass:"content_right"},[a("div",{staticClass:"top_search"},[a("div",[a("a-input-search",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入关键字搜索",allowClear:""},on:{search:e.searchTable},model:{value:e.pagination.search_data,callback:function(t){e.$set(e.pagination,"search_data",t)},expression:"pagination.search_data"}},[a("a-select",{staticStyle:{width:"100px"},attrs:{slot:"addonBefore"},slot:"addonBefore",model:{value:e.pagination.search_type,callback:function(t){e.$set(e.pagination,"search_type",t)},expression:"pagination.search_type"}},e._l(e.searchList,(function(t){return a("a-select-option",{key:t.key},[e._v(e._s(t.name))])})),1)],1)],1),a("div",[a("a-button",{staticStyle:{"margin-right":"10px"},attrs:{icon:"reload"},on:{click:e.refresh}},[e._v("刷新")]),e.$store.state.btnAuth.btnAuth.bastion_host_create?a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.$refs.AddHost.show(e.selectGroupId)}}},[e._v("新建")]):e._e()],1)]),a("a-table",{attrs:{loading:e.tableLoading,pagination:e.pagination,"row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},columns:e.columns,"data-source":e.tableData},on:{change:e.onChange},scopedSlots:e._u([{key:"name",fn:function(t,s){return[e.$store.state.btnAuth.btnAuth.bastion_host_details?a("a",{attrs:{title:t},on:{click:function(t){return e.$router.push({path:"/resources/host/hostDetails",query:{id:s.id}})}}},[e._v(e._s(t))]):a("span",[e._v(e._s(t))])]}},{key:"voucher",fn:function(t,s){return[e.$store.state.btnAuth.btnAuth.bastion_host_details?a("a",{on:{click:function(t){return e.$router.push({path:"/resources/host/hostDetails",query:{id:s.id}})}}},[e._v(e._s(t))]):a("span",[e._v(e._s(t))])]}},{key:"action",fn:function(t,s){return[e.$store.state.btnAuth.btnAuth.bastion_host_details?a("a-button",{attrs:{size:"small",type:"link"},on:{click:function(t){return e.$router.push({path:"/resources/host/hostDetails",query:{id:s.id}})}}},[e._v("查看")]):e._e(),e.$store.state.btnAuth.btnAuth.bastion_host_login?a("a-button",{attrs:{size:"small",type:"link"},on:{click:function(t){return e.handleLogin(s)}}},[e._v("登录")]):e._e(),e.$store.state.btnAuth.btnAuth.bastion_host_update?a("a-button",{attrs:{size:"small",type:"link"},on:{click:function(t){return e.$refs.AddHost.show(e.selectGroupId,s)}}},[e._v("编辑")]):e._e(),e.$store.state.btnAuth.btnAuth.bastion_host_delete?a("a-button",{staticStyle:{color:"#333"},attrs:{size:"small",type:"link"},on:{click:function(t){return e.deleteHost(s)}}},[e._v("删除")]):e._e()]}}])},[a("template",{slot:"voucherTitle"},[a("span",[e._v("关联资源凭证")]),a("a-tooltip",{attrs:{placement:"top",title:"密码凭证/SSH密钥/凭证分组","arrow-point-at-center":""}},[a("a-icon",{staticStyle:{margin:"0 0 0 3px",color:"#666"},attrs:{type:"exclamation-circle"}})],1)],1)],2),e.tableData.length>0?a("a-button",{staticStyle:{float:"left",margin:"-50px 10px 0 0"},attrs:{disabled:0==e.selectedRowKeys.length,icon:"delete"},on:{click:e.batchDelete}},[e._v("批量删除")]):e._e()],1)])]),a("AddGroup",{ref:"AddGroup",on:{father:e.getHostGroupData}}),a("AddHost",{ref:"AddHost",attrs:{fatherData:e.fatherData},on:{father:function(t){e.getHostData(),e.getHostGroupData()},"update:fatherData":function(t){e.fatherData=t},"update:father-data":function(t){e.fatherData=t}}}),a("LoginHostModal",{ref:"LoginHostModal"}),a("AddFromCmdb",{ref:"AddFromCmdb",attrs:{fatherData:e.fatherData},on:{father:function(t){e.getHostData(),e.getHostGroupData()},"update:fatherData":function(t){e.fatherData=t},"update:father-data":function(t){e.fatherData=t}}})],1)},r=[],o=(a("d81d"),a("b0c0"),a("d3b7"),a("96cf"),a("1da1")),i=a("0977"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-drawer",{attrs:{"body-style":{paddingBottom:"80px"},width:"1020px",title:e.title,placement:"right",visible:e.visible},on:{close:e.onClose}},[a("a-form",{attrs:{form:e.hostForm,"label-col":{span:3},"wrapper-col":{span:21}}},[a("a-form-item",{attrs:{label:"主机名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["host_name",{rules:[{required:!0,message:"请输入主机名称"}]}],expression:"['host_name', { rules: [{ required: true, message: '请输入主机名称' }] }]"}],attrs:{placeholder:"请输入主机名称"}})],1),"add"==e.handleType||"edit"==e.handleType&&!e.activeHost.host_name_code?a("a-form-item",{attrs:{label:"唯一标识"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["host_name_code",{rules:[{required:!0,message:"请输入唯一标识"},{pattern:/^[^\u4e00-\u9fa5]*$/,message:"唯一标识不能含有中文"}]}],expression:"['host_name_code', { rules: [{ required: true, message: '请输入唯一标识' },\n                {pattern:/^[^\\u4e00-\\u9fa5]*$/,message:'唯一标识不能含有中文'}] }]"}],attrs:{placeholder:"请输入唯一标识"}})],1):e._e(),a("a-form-item",{attrs:{label:"系统类型"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["system_type",{rules:[{required:!0,message:"请选择系统类型"}]}],expression:"['system_type', { rules: [{ required: true, message: '请选择系统类型' }] }]"}],attrs:{placeholder:"请选择系统类型"},on:{change:e.systemChange}},[a("a-select-option",{attrs:{value:"Windows"}},[e._v("Windows")]),a("a-select-option",{attrs:{value:"Linux"}},[e._v("Linux")])],1)],1),a("a-form-item",{attrs:{label:"协议类型"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["protocol_type",{rules:[{required:!0,message:"请选择协议类型"}]}],expression:"['protocol_type', { rules: [{ required: true, message: '请选择协议类型' }] }]"}],attrs:{placeholder:"请选择协议类型"}},[a("a-select-option",{attrs:{value:"SSH"}},[e._v("SSH")]),a("a-select-option",{attrs:{value:"RDP"}},[e._v("RDP")])],1)],1),a("a-form-item",{attrs:{label:"主机地址"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["host_address",{rules:[{required:!0,message:"请输入有效的IP地址或域名"}]}],expression:"['host_address', { rules: [{ required: true, message: '请输入有效的IP地址或域名' }] }]"}],attrs:{placeholder:"请输入有效的IP地址或域名"}})],1),a("a-form-item",{attrs:{label:"端口"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["port",{rules:[{required:!0,message:"请输入1~65535之间的有效数字"}]}],expression:"['port', { rules: [{ required: true, message: '请输入1~65535之间的有效数字' }] }]"}],staticStyle:{width:"838px"},attrs:{min:1,max:65535,placeholder:"请输入1~65535之间的有效数字"}})],1),a("a-form-item",{attrs:{label:"所属分组"}},[a("a-tree-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["group",{rules:[{required:!0,message:"请选择所属分组"}]}],expression:"['group', { rules: [{ required: true, message: '请选择所属分组' }] }]"}],attrs:{"tree-data":e.fatherData,placeholder:"请选择分组"}})],1),a("a-form-item",{attrs:{label:"主机描述"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["description",{rules:[{required:!1},{max:200,message:"最多输入200个汉字或字符"}]}],expression:"['description', { rules: [{ required: false},{max:200,message:'最多输入200个汉字或字符'}] }]"}],attrs:{placeholder:"请输入，最多输入200个汉字或字符"}})],1),a("a-form-item",{attrs:{label:"网络代理"}},[a("a-radio-group",{model:{value:e.showNetwork,callback:function(t){e.showNetwork=t},expression:"showNetwork"}},[a("a-radio",{attrs:{value:!1}},[e._v(" 不使用代理 ")]),a("a-radio",{attrs:{value:!0}},[e._v(" 使用代理 ")])],1),e.showNetwork?a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["network_proxy",{rules:[{required:!1}]}],expression:"['network_proxy', { rules: [{ required: false}] }]"}],attrs:{placeholder:"请选择网络代理"}},e._l(e.networkProxyList,(function(t){return a("a-select-option",{key:t.id},[e._v(" "+e._s(t.name)+" ")])})),1):e._e()],1),a("a-form-item",{attrs:{label:"添加凭证"}},[a("a-radio-group",{attrs:{"button-style":"solid"},model:{value:e.addMethodType,callback:function(t){e.addMethodType=t},expression:"addMethodType"}},["add"==e.handleType?a("a-radio-button",{attrs:{value:"immediately"}},[e._v(" 立即添加 ")]):e._e(),"add"==e.handleType?a("a-radio-button",{attrs:{value:"future"}},[e._v(" 以后添加 ")]):e._e(),a("a-radio-button",{attrs:{value:"have"}},[e._v(" 选择已有 ")])],1)],1)],1),"immediately"==e.addMethodType?a("a-form",{attrs:{form:e.voucherForm,"label-col":{span:3},"wrapper-col":{span:21}}},[a("a-form-item",{attrs:{label:"登录方式"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["login_type",{initialValue:"auto",rules:[{required:!0,message:"请选择登录方式"}]}],expression:"['login_type', { initialValue: 'auto' ,rules: [{ required: true, message: '请选择登录方式' }] }]"}],on:{change:e.loginTypeChange}},[a("a-radio",{attrs:{value:"auto"}},[e._v(" 自动登录 ")]),a("a-radio",{attrs:{value:"hand"}},[e._v(" 手动登录 ")])],1)],1),a("a-form-item",{attrs:{label:"验证方式"}},[a("a-select",{model:{value:e.verificationMethod,callback:function(t){e.verificationMethod=t},expression:"verificationMethod"}},[a("a-select-option",{attrs:{value:"password"}},[e._v("密码凭证")]),a("a-select-option",{attrs:{value:"ssh_key"}},[e._v("SSH密钥")])],1)],1),a("a-form-item",{attrs:{label:"凭证名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入凭证名称"}]}],expression:"['name', { rules: [{ required: true, message: '请输入凭证名称' }] }]"}],attrs:{placeholder:"请输入凭证名称"}})],1),a("a-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[a("span",[e._v("资源账户")]),a("a-tooltip",{attrs:{title:"资源账户是指操作系统登录账号"}},[a("a-icon",{staticStyle:{margin:"0 0 0 3px",color:"#666"},attrs:{type:"exclamation-circle"}})],1)],1),a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["login_name",{rules:[{required:!0,message:"请输入资源账户"},{pattern:/^[^\u4e00-\u9fa5]*$/,message:"资源账户不能含有中文"}]}],expression:"['login_name', { rules: [{ required:true, message: '请输入资源账户' },{pattern:/^[^\\u4e00-\\u9fa5]*$/,message:'资源账户不能含有中文'}] }]"}],attrs:{autocomplete:"new-password",placeholder:"请输入资源账户的名称"}})],1),"password"==e.verificationMethod?a("div",["auto"==e.loginType?[a("a-form-item",{attrs:{label:"密码"}},[a("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["login_password",{rules:[{required:!0,message:"请输入密码"},{pattern:/^[^\u4e00-\u9fa5]*$/,message:"密码不能含有中文"}]}],expression:"['login_password', { rules: [{ required: true, message: '请输入密码' },{pattern:/^[^\\u4e00-\\u9fa5]*$/,message:'密码不能含有中文'}] }]"}],attrs:{autocomplete:"new-password",placeholder:"请输入密码"}})],1)]:e._e()],2):a("div",[a("a-form-item",{attrs:{label:"SSH key"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["ssh_key",{rules:[{required:!0,message:"请输入SSH key"}]}],expression:"['ssh_key', { rules: [{ required:true, message: '请输入SSH key' }] }]"}],attrs:{placeholder:"请输入SSH key",rows:4}})],1),"auto"==e.loginType?[a("a-form-item",{attrs:{label:"Passphrase"}},[a("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["passphrase",{rules:[{required:!1,message:"请输入Passphrase"},{pattern:/^[^\u4e00-\u9fa5]*$/,message:"Passphrase不能含有中文"}]}],expression:"['passphrase', { rules: [{ required: false, message: '请输入Passphrase' },{pattern:/^[^\\u4e00-\\u9fa5]*$/,message:'Passphrase不能含有中文'}] }]"}],attrs:{placeholder:"请输入Passphrase"}})],1)]:e._e()],2),a("a-form-item",{attrs:{label:"描述"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["description",{rules:[{required:!1},{max:200,message:"最多输入200个汉字或字符"}]}],expression:"['description', { rules: [{ required: false},{max:200,message:'最多输入200个汉字或字符'}] }]"}],attrs:{placeholder:"请输入，最多输入200个汉字或字符"}})],1)],1):e._e(),"have"==e.addMethodType?a("a-form",{attrs:{form:e.voucherForm,"label-col":{span:3},"wrapper-col":{span:21}}},[a("a-form-item",{attrs:{label:"添加凭证"}},[a("a-radio-group",{model:{value:e.credential_type,callback:function(t){e.credential_type=t},expression:"credential_type"}},[a("a-radio",{attrs:{value:"password"}},[e._v(" 密码凭证 ")]),a("a-radio",{attrs:{value:"ssh"}},[e._v(" SSH密钥 ")]),a("a-radio",{attrs:{value:"group"}},[e._v(" 凭证分组 ")])],1)],1),a("a-transfer",{staticStyle:{margin:"0 0 0 12.5%"},attrs:{operations:e.operations,titles:e.titles,"list-style":e.listStyle,dataSource:e.mockData,targetKeys:e.targetKeys,"show-search":"",render:e.transferRender},on:{change:e.handleChange}})],1):e._e(),a("footer",[a("a-button",{on:{click:e.onClose}},[e._v("取消")]),a("a-button",{staticStyle:{margin:"0 0 0 8px"},attrs:{loading:e.btnLoading,type:"primary"},on:{click:e.onSubmit}},[e._v("保存")])],1)],1)],1)},l=[],d=(a("99af"),a("3ca3"),a("ddb0"),a("4246")),c=a("23ba"),u=a("cb20"),h=a("2783"),p={data:function(){return{title:"",visible:!1,btnLoading:!1,hostForm:this.$form.createForm(this,{name:"hostForm"}),handleType:"",activeHost:{},addMethodType:"immediately",voucherForm:this.$form.createForm(this,{name:"voucherForm"}),loginType:"auto",verificationMethod:"password",listStyle:{width:"360px",height:"420px"},titles:[],titles1:["可添加的密码凭据","已选择的密码凭据"],titles2:["可添加的SSH密钥","已选择的SSH密钥"],titles3:["可添加的凭据分组","已选择的凭据分组"],operations:["加入右侧","加入左侧"],mockData:[],targetKeys:[],credential_type:"password",allpasswordList:[],passwordList:[],selectedpasswordList:[],allsshList:[],sshList:[],selectedsshList:[],allgroupList:[],groupList:[],selectedgroupList:[],showNetwork:!1,networkProxyList:[]}},props:["fatherData"],mounted:function(){},watch:{credential_type:{handler:function(e,t){"password"==t?this.selectedpasswordList=this.targetKeys:"ssh"==t?this.selectedsshList=this.targetKeys:"group"==t&&(this.selectedgroupList=this.targetKeys),"password"==e?(this.titles=this.titles1,this.mockData=this.passwordList,this.targetKeys=this.selectedpasswordList):"ssh"==e?(this.titles=this.titles2,this.mockData=this.sshList,this.targetKeys=this.selectedsshList):"group"==e&&(this.titles=this.titles3,this.mockData=this.groupList,this.targetKeys=this.selectedgroupList)}}},methods:{getNetworkProxyList:function(){var e=this;Object(h["d"])({all_data:1}).then((function(t){200==t.code&&t.data&&(e.networkProxyList=t.data)}))},transferRender:function(e){var t,a=this.$createElement;return t="group"==this.credential_type?e.passwordNumber||e.sshNumber?a("span",{class:"custom-item"},[a("span",{style:"margin:0 10px 0 0"},[e.title]),a("span",["(",e.passwordNumber,"/",e.sshNumber,")"])]):a("span",{class:"custom-item"},[a("a-tooltip",{attrs:{placement:"top",title:"该分组没有关联密码凭证和SSH密钥,不可选择。"}},[a("span",{style:"margin:0 10px 0 0"},[e.title]),a("span",["(",e.passwordNumber,"/",e.sshNumber,")"])])]):a("span",{class:"custom-item"},[e.title]),{label:t,value:e.title}},getAllCredential:function(){var e=this;Object(u["d"])({all_data:"1",credential_type:"password"}).then((function(t){if(200==t.code&&t.data){var a=[];t.data.map((function(e){a.push({key:e.id+"",title:e.name})})),e.allpasswordList=a,e.passwordList=e.allpasswordList,e.mockData=e.passwordList}})),Object(u["d"])({all_data:"1",credential_type:"ssh_key"}).then((function(t){if(200==t.code&&t.data){var a=[];t.data.map((function(e){a.push({key:e.id+"",title:e.name})})),e.allsshList=a,e.sshList=e.allsshList}})),Object(c["d"])({all_data:"1"}).then((function(t){if(200==t.code&&t.data){var a=[];t.data.map((function(e){var t,s,r,o,i=(null===(t=e.credential)||void 0===t||null===(s=t.password_credential)||void 0===s?void 0:s.length)||0,n=(null===(r=e.credential)||void 0===r||null===(o=r.ssh_credential)||void 0===o?void 0:o.length)||0;a.push({key:e.id+"",title:e.name,passwordNumber:i,sshNumber:n,disabled:!i&&!n})})),e.allgroupList=a,e.groupList=e.allgroupList}}))},handleChange:function(e,t,a){this.targetKeys=e},systemChange:function(e){"Windows"==e?this.hostForm.setFieldsValue({protocol_type:"RDP",port:3389}):this.hostForm.setFieldsValue({protocol_type:"SSH",port:22})},onSubmit:function(){var e,t,a=this,s=new Promise((function(t,s){a.hostForm.validateFields((function(a,s){a||(e=s,t())}))})),r=new Promise((function(e,s){a.voucherForm.validateFields((function(a,s){a||(t=s,e())}))}));Promise.all([s,r]).then((function(s){a.btnLoading=!0;var r=e;r.resource_from="hand","immediately"==a.addMethodType?(r.credential=t,r.credential.credential_type=a.verificationMethod):"have"==a.addMethodType&&("password"==a.credential_type?a.selectedpasswordList=a.targetKeys:"ssh"==a.credential_type?a.selectedsshList=a.targetKeys:"group"==a.credential_type&&(a.selectedgroupList=a.targetKeys),r.credential_list=a.selectedpasswordList.concat(a.selectedsshList),r.credential_group_list=a.selectedgroupList),"add"==a.handleType?Object(d["a"])(r).then((function(e){200==e.code&&(a.$message.success(e.message),a.onClose(),a.$emit("father"))})).finally((function(){a.btnLoading=!1})):(r.id=a.activeHost.id,r.host_name_code||(r.host_name_code=a.activeHost.host_name_code),Object(d["f"])(r).then((function(e){200==e.code&&(a.$message.success(e.message),a.onClose(),a.$emit("father"))})).finally((function(){a.btnLoading=!1})))}))},onClose:function(){this.visible=!1,this.hostForm.resetFields(),this.targetKeys=[],this.voucherForm.resetFields(),this.selectedpasswordList=[],this.selectedsshList=[],this.selectedgroupList=[],this.credential_type="password",this.showNetwork=!1,this.verificationMethod="password"},show:function(e,t){if(this.visible=!0,this.getAllCredential(),this.getNetworkProxyList(),this.titles=this.titles1,t){var a;this.title="修改主机",this.activeHost=t,this.handleType="edit",this.addMethodType="have";var s=[],r=[],o=[];t.credential.password_credential&&t.credential.password_credential.map((function(e){s.push(e.id+"")})),this.selectedpasswordList=s,t.credential.ssh_credential&&t.credential.ssh_credential.map((function(e){r.push(e.id+"")})),this.selectedsshList=r,t.credential.credential_group&&t.credential.credential_group.map((function(e){o.push(e.id+"")})),this.selectedgroupList=o,this.targetKeys=this.selectedpasswordList,(null===(a=t.network_proxy)||void 0===a?void 0:a.id)&&(this.showNetwork=!0),this.$nextTick((function(){var e;this.hostForm.setFieldsValue({host_name:t.host_name,system_type:t.system_type,protocol_type:t.protocol_type,host_address:t.host_address,port:t.port,group:t.group.id,network_proxy:null===(e=t.network_proxy)||void 0===e?void 0:e.id})}))}else this.loginType="auto",this.addMethodType="immediately",this.title="新建主机",this.handleType="add",e&&"all"!=e?this.$nextTick((function(){this.hostForm.setFieldsValue({group:e})})):this.$nextTick((function(){this.hostForm.setFieldsValue({group:1})}))},loginTypeChange:function(e){this.loginType=e.target.value}}},m=p,f=(a("043d"),a("2877")),g=Object(f["a"])(m,n,l,!1,null,"0c28fc4d",null),v=g.exports,y=a("ce17"),b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{confirmLoading:e.btnLoading,title:e.title},on:{ok:e.onGroupSubmit},model:{value:e.visiable,callback:function(t){e.visiable=t},expression:"visiable"}},[a("a-form",{attrs:{form:e.groupForm}},[a("a-form-item",{attrs:{label:"分组名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请填写分组名称"}]}],expression:"['name', { rules: [{ required: true, message: '请填写分组名称' }] }]"}]})],1)],1)],1)},_=[],w={data:function(){return{visiable:!1,groupForm:this.$form.createForm(this,{name:"groupForm"}),title:"",btnLoading:!1}},methods:{show:function(e,t){this.groupForm.resetFields(),this.visiable=!0,this.type=t,this.activeGroup=e,"edit"==t?(this.title="编辑分组",this.$nextTick((function(){this.groupForm.setFieldsValue({name:e.title})}))):this.title="添加分组"},onGroupSubmit:function(){var e=this;this.groupForm.validateFields((function(t,a){if(e.btnLoading=!0,!t){var s=a;"add"==e.type?("all"!=e.activeGroup.key?s.parent=e.activeGroup.key:s.parent=null,Object(d["b"])(s).then((function(t){200==t.code&&(e.$message.success(t.message),e.$emit("father"),e.visiable=!1)})).finally((function(){e.btnLoading=!1}))):(s.id=e.activeGroup.id,Object(d["g"])(s).then((function(t){200==t.code&&(e.$message.success(t.message),e.$emit("father"),e.visiable=!1)})).finally((function(){e.btnLoading=!1})))}}))}}},k=w,L=Object(f["a"])(k,b,_,!1,null,"2f4876d0",null),x=L.exports,S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-drawer",{attrs:{"body-style":{paddingBottom:"80px"},width:"1080px",title:"资源平台导入",placement:"right",visible:e.visible},on:{close:e.onClose}},[a("a-tabs",{on:{change:e.tabsChange},model:{value:e.tabKey,callback:function(t){e.tabKey=t},expression:"tabKey"}},[a("a-tab-pane",{key:"SERVER",attrs:{tab:"物理机 ("+e.number.SERVER+")"}}),a("a-tab-pane",{key:"VIRTUAL_SERVER",attrs:{tab:"虚拟机 ("+e.number.VIRTUAL_SERVER+")","force-render":""}}),a("a-tab-pane",{key:"CLOUD_SERVER",attrs:{tab:"云主机 ("+e.number.CLOUD_SERVER+")"}})],1),a("div",{staticStyle:{margin:"0 0 12px 0"}},[a("a-input-search",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入关键字搜索",allowClear:""},on:{search:e.searchTable},model:{value:e.pagination.search_data,callback:function(t){e.$set(e.pagination,"search_data",t)},expression:"pagination.search_data"}},[a("a-select",{staticStyle:{width:"100px"},attrs:{slot:"addonBefore"},slot:"addonBefore",model:{value:e.pagination.search_type,callback:function(t){e.$set(e.pagination,"search_type",t)},expression:"pagination.search_type"}},e._l(e.searchList,(function(t){return a("a-select-option",{key:t.key},[e._v(e._s(t.name))])})),1)],1)],1),a("a-table",{attrs:{loading:e.tableLoading,columns:e.columns,dataSource:e.tableData,"row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},pagination:{showSizeChanger:!0,showQuickJumper:!0,showTotal:function(e){return"共有 "+e+" 条数据"}}},scopedSlots:e._u([{key:"ip1",fn:function(t){return a("span",{},[e._v(e._s(t||"--"))])}},{key:"ip2",fn:function(t){return a("span",{},[e._v(e._s(t||"--"))])}},{key:"opt_os",fn:function(t){return a("span",{},[e._v(e._s(t||"--"))])}},{key:"action",fn:function(t,s){return a("span",{},[a("a-button",{attrs:{size:"small",type:"link"},on:{click:function(t){return e.$refs.AddHostFromCmdb.show(s,e.selectGroupId)}}},[e._v("配置")])],1)}}])}),e.tableData.length>0?a("a-button",{staticStyle:{float:"left",margin:"-50px 10px 0 0"},attrs:{disabled:0==e.selectedRowKeys.length,icon:"plus"},on:{click:function(t){return e.$refs.BatchAddition.show(e.selectedRowKeys,e.selectGroupId)}}},[e._v("批量配置")]):e._e(),a("AddHostFromCmdb",{ref:"AddHostFromCmdb",attrs:{fatherData:e.fatherData},on:{father:function(t){return e.getAgentData()},"update:fatherData":function(t){e.fatherData=t},"update:father-data":function(t){e.fatherData=t}}}),a("BatchAddition",{ref:"BatchAddition",attrs:{fatherData:e.fatherData,fatherTableData:e.tableData},on:{father:function(t){return e.getAgentData()},"update:fatherData":function(t){e.fatherData=t},"update:father-data":function(t){e.fatherData=t},"update:fatherTableData":function(t){e.tableData=t},"update:father-table-data":function(t){e.tableData=t}}})],1)],1)},D=[],A=(a("4de4"),a("b775")),H=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(A["b"])({url:"get-agent/",method:"get",params:e})},T=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-modal",{attrs:{width:"1000px",visible:e.visible,title:"配置",confirmLoading:e.btnLoading},on:{cancel:e.onClose,ok:e.onSubmit}},[a("a-form",{attrs:{form:e.hostForm,"label-col":{span:2},"wrapper-col":{span:22}}},[a("a-form-item",{attrs:{label:"主机名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["host_name",{rules:[{required:!0,message:"请输入主机名称"}]}],expression:"['host_name', { rules: [{ required: true, message: '请输入主机名称' }] }]"}],attrs:{placeholder:"请输入主机名称"}})],1),a("a-form-item",{attrs:{label:"系统类型"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["system_type",{rules:[{required:!0,message:"请选择系统类型"}]}],expression:"['system_type', { rules: [{ required: true, message: '请选择系统类型' }] }]"}],attrs:{placeholder:"请选择系统类型"},on:{change:e.systemChange}},[a("a-select-option",{attrs:{value:"Windows"}},[e._v("Windows")]),a("a-select-option",{attrs:{value:"Linux"}},[e._v("Linux")])],1)],1),a("a-form-item",{attrs:{label:"协议类型"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["protocol_type",{rules:[{required:!0,message:"请选择协议类型"}]}],expression:"['protocol_type', { rules: [{ required: true, message: '请选择协议类型' }] }]"}],attrs:{placeholder:"请选择协议类型"}},[a("a-select-option",{attrs:{value:"SSH"}},[e._v("SSH")]),a("a-select-option",{attrs:{value:"RDP"}},[e._v("RDP")])],1)],1),a("a-form-item",{attrs:{label:"主机地址"}},[a("a-input",{directives:[{name:"show",rawName:"v-show",value:""==e.selectedHost.ip1||null==e.selectedHost.ip1||""==e.selectedHost.ip2||null==e.selectedHost.ip2,expression:"selectedHost.ip1 == '' || selectedHost.ip1 == null || selectedHost.ip2 == '' || selectedHost.ip2 ==null"},{name:"decorator",rawName:"v-decorator",value:["host_address",{rules:[{required:!0,message:"请输入IP地址"}]}],expression:"['host_address', { rules: [{ required: true, message: '请输入IP地址' }] }]"}],attrs:{disabled:null!=e.selectedHost.ip1&&""!=e.selectedHost.ip1&&(null==e.selectedHost.ip2||""==e.selectedHost.ip2)||null!=e.selectedHost.ip2&&""!=e.selectedHost.ip2&&(null==e.selectedHost.ip1||""==e.selectedHost.ip1),placeholder:"输入IP地址"}}),a("a-select",{directives:[{name:"show",rawName:"v-show",value:e.selectedHost.ip1&&""!=e.selectedHost.ip1&&e.selectedHost.ip2&&""!=e.selectedHost.ip2,expression:"selectedHost.ip1 && selectedHost.ip1 != '' && selectedHost.ip2 && selectedHost.ip2 != ''"},{name:"decorator",rawName:"v-decorator",value:["host_address",{rules:[{required:!0,message:"请选择IP地址"}]}],expression:"['host_address', { rules: [{ required: true, message: '请选择IP地址' }] }]"}],attrs:{placeholder:"请选择IP地址"}},e._l(e.ipList,(function(t){return a("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label+" "+t.value))])})),1)],1),a("a-form-item",{attrs:{label:"端口"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["port",{rules:[{required:!0,message:"请输入1~65535之间的有效数字"}]}],expression:"['port', { rules: [{ required: true, message: '请输入1~65535之间的有效数字' }] }]"}],staticStyle:{width:"872px"},attrs:{min:1,max:65535,placeholder:"请输入1~65535之间的有效数字"}})],1),a("a-form-item",{attrs:{label:"所属分组"}},[a("a-tree-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["group",{rules:[{required:!0,message:"请选择所属分组"}]}],expression:"['group', { rules: [{ required: true, message: '请选择所属分组' }] }]"}],attrs:{"tree-data":e.fatherData,placeholder:"请选择分组"}})],1),a("a-form-item",{attrs:{label:"主机描述"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["description",{rules:[{required:!1},{max:200,message:"最多输入200个汉字或字符"}]}],expression:"['description', { rules: [{ required: false},{max:200,message:'最多输入200个汉字或字符'}] }]"}],attrs:{placeholder:"请输入，最多输入200个汉字或字符"}})],1),a("a-form-item",{attrs:{label:"添加凭证"}},[a("a-radio-group",{attrs:{"button-style":"solid"},model:{value:e.addMethodType,callback:function(t){e.addMethodType=t},expression:"addMethodType"}},[a("a-radio-button",{attrs:{value:"immediately"}},[e._v(" 立即添加 ")]),a("a-radio-button",{attrs:{value:"future"}},[e._v(" 以后添加 ")]),a("a-radio-button",{attrs:{value:"have"}},[e._v(" 选择已有 ")])],1)],1)],1),"immediately"==e.addMethodType?a("a-form",{attrs:{form:e.voucherForm,"label-col":{span:2},"wrapper-col":{span:22}}},[a("a-form-item",{attrs:{label:"登录方式"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["login_type",{initialValue:"auto",rules:[{required:!0,message:"请选择登录方式"}]}],expression:"['login_type', { initialValue: 'auto' ,rules: [{ required: true, message: '请选择登录方式' }] }]"}],on:{change:e.loginTypeChange}},[a("a-radio",{attrs:{value:"auto"}},[e._v(" 自动登录 ")]),a("a-radio",{attrs:{value:"hand"}},[e._v(" 手动登录 ")])],1)],1),a("a-form-item",{attrs:{label:"验证方式"}},[a("a-select",{model:{value:e.verificationMethod,callback:function(t){e.verificationMethod=t},expression:"verificationMethod"}},[a("a-select-option",{attrs:{value:"password"}},[e._v("密码凭证")]),a("a-select-option",{attrs:{value:"ssh_key"}},[e._v("SSH密钥")])],1)],1),a("a-form-item",{attrs:{label:"凭证名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入凭证名称"}]}],expression:"['name', { rules: [{ required: true, message: '请输入凭证名称' }] }]"}],attrs:{placeholder:"请输入凭证名称"}})],1),a("a-form-item",{attrs:{label:"资源账户"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["login_name",{rules:[{required:!0,message:"请输入资源账户"}]}],expression:"['login_name', { rules: [{ required:true, message: '请输入资源账户' }] }]"}],attrs:{autoComplete:"off",placeholder:"请输入资源账户的名称"}})],1),"password"==e.verificationMethod?a("div",["auto"==e.loginType?[a("a-form-item",{attrs:{label:"密码"}},[a("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["login_password",{rules:[{required:!0,message:"请输入密码"}]}],expression:"['login_password', { rules: [{ required: true, message: '请输入密码' }] }]"}],attrs:{autoComplete:"off",placeholder:"请输入密码"}})],1)]:e._e()],2):a("div",[a("a-form-item",{attrs:{label:"SSH key"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["ssh_key",{rules:[{required:!0,message:"请输入SSH key"}]}],expression:"['ssh_key', { rules: [{ required:true, message: '请输入SSH key' }] }]"}],attrs:{placeholder:"请输入SSH key",rows:4}})],1),"auto"==e.loginType?[a("a-form-item",{attrs:{label:"Passphrase"}},[a("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["passphrase",{rules:[{required:!1,message:"请输入Passphrase"}]}],expression:"['passphrase', { rules: [{ required: false, message: '请输入Passphrase' }] }]"}],attrs:{placeholder:"请输入Passphrase"}})],1)]:e._e()],2),a("a-form-item",{attrs:{label:"描述"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["description",{rules:[{required:!1},{max:200,message:"最多输入200个汉字或字符"}]}],expression:"['description', { rules: [{ required: false},{max:200,message:'最多输入200个汉字或字符'}] }]"}],attrs:{placeholder:"请输入，最多输入200个汉字或字符"}})],1)],1):e._e(),"have"==e.addMethodType?a("a-form",{attrs:{form:e.voucherForm,"label-col":{span:2},"wrapper-col":{span:22}}},[a("a-form-item",{attrs:{label:"添加凭证"}},[a("a-radio-group",{model:{value:e.credential_type,callback:function(t){e.credential_type=t},expression:"credential_type"}},[a("a-radio",{attrs:{value:"password"}},[e._v(" 密码凭证 ")]),a("a-radio",{attrs:{value:"ssh"}},[e._v(" SSH密钥 ")]),a("a-radio",{attrs:{value:"group"}},[e._v(" 凭证分组 ")])],1)],1),a("a-transfer",{staticStyle:{margin:"0 0 0 8.33%"},attrs:{operations:e.operations,titles:e.titles,"list-style":e.listStyle,dataSource:e.mockData,targetKeys:e.targetKeys,"show-search":"",render:e.transferRender},on:{change:e.handleChange}})],1):e._e()],1)],1)},C=[],F=(a("c975"),{data:function(){return{visible:!1,btnLoading:!1,hostForm:this.$form.createForm(this,{name:"hostForm"}),addMethodType:"immediately",voucherForm:this.$form.createForm(this,{name:"voucherForm"}),loginType:"auto",verificationMethod:"password",listStyle:{width:"360px",height:"420px"},titles:[],titles1:["可添加的密码凭据","已选择的密码凭据"],titles2:["可添加的SSH密钥","已选择的SSH密钥"],titles3:["可添加的凭据分组","已选择的凭据分组"],operations:["加入右侧","加入左侧"],mockData:[],targetKeys:[],credential_type:"password",allpasswordList:[],passwordList:[],selectedpasswordList:[],allsshList:[],sshList:[],selectedsshList:[],allgroupList:[],groupList:[],selectedgroupList:[],selectedHost:{},ipList:[]}},props:["fatherData"],watch:{credential_type:{handler:function(e,t){"password"==t?this.selectedpasswordList=this.targetKeys:"ssh"==t?this.selectedsshList=this.targetKeys:"group"==t&&(this.selectedgroupList=this.targetKeys),"password"==e?(this.titles=this.titles1,this.mockData=this.passwordList,this.targetKeys=this.selectedpasswordList):"ssh"==e?(this.titles=this.titles2,this.mockData=this.sshList,this.targetKeys=this.selectedsshList):"group"==e&&(this.titles=this.titles3,this.mockData=this.groupList,this.targetKeys=this.selectedgroupList)}}},methods:{transferRender:function(e){var t,a=this.$createElement;return t="group"==this.credential_type?e.passwordNumber||e.sshNumber?a("span",{class:"custom-item"},[a("span",{style:"margin:0 10px 0 0"},[e.title]),a("span",["(",e.passwordNumber,"/",e.sshNumber,")"])]):a("span",{class:"custom-item"},[a("a-tooltip",{attrs:{placement:"top",title:"该分组没有关联密码凭证和SSH密钥,不可选择。"}},[a("span",{style:"margin:0 10px 0 0"},[e.title]),a("span",["(",e.passwordNumber,"/",e.sshNumber,")"])])]):a("span",{class:"custom-item"},[e.title]),{label:t,value:e.title}},onClose:function(){this.visible=!1,this.hostForm.resetFields(),this.targetKeys=[],this.voucherForm.resetFields(),this.selectedpasswordList=[],this.selectedsshList=[],this.selectedgroupList=[]},systemChange:function(e){"Windows"==e?this.hostForm.setFieldsValue({protocol_type:"RDP",port:3389}):"Linux"==e&&this.hostForm.setFieldsValue({protocol_type:"SSH",port:22})},handleChange:function(e,t,a){this.targetKeys=e},loginTypeChange:function(e){this.loginType=e.target.value},getAllCredential:function(){var e=this;Object(u["d"])({all_data:"1",credential_type:"password"}).then((function(t){if(200==t.code&&t.data){var a=[];t.data.map((function(e){a.push({key:e.id+"",title:e.name})})),e.allpasswordList=a,e.passwordList=e.allpasswordList,e.mockData=e.passwordList}})),Object(u["d"])({all_data:"1",credential_type:"ssh_key"}).then((function(t){if(200==t.code&&t.data){var a=[];t.data.map((function(e){a.push({key:e.id+"",title:e.name})})),e.allsshList=a,e.sshList=e.allsshList}})),Object(c["d"])({all_data:"1"}).then((function(t){if(200==t.code&&t.data){var a=[];t.data.map((function(e){var t,s,r,o,i=(null===(t=e.credential)||void 0===t||null===(s=t.password_credential)||void 0===s?void 0:s.length)||0,n=(null===(r=e.credential)||void 0===r||null===(o=r.ssh_credential)||void 0===o?void 0:o.length)||0;a.push({key:e.id+"",title:e.name,passwordNumber:i,sshNumber:n,disabled:!i&&!n})})),e.allgroupList=a,e.groupList=e.allgroupList}}))},show:function(e,t){var a;this.selectedHost=e,this.visible=!0,this.credential_type="password",this.getAllCredential(),this.titles=this.titles1,this.loginType="auto",this.addMethodType="immediately",e.opt_os&&e.opt_os.indexOf("Window")>-1?(a="Windows",this.$nextTick((function(){this.systemChange("Windows")}))):e.opt_os&&-1==e.opt_os.indexOf("window")?(a="Linux",this.$nextTick((function(){this.systemChange("Linux")}))):a="",this.$nextTick((function(){this.hostForm.setFieldsValue({host_name:e.show_name,system_type:a,host_address:e.ip1||e.ip2})})),e.ip1&&""!=e.ip1&&e.ip2&&""!=e.ip2&&(this.ipList=[{label:"公网IP",value:e.ip1},{label:"内网IP",value:e.ip2}]),t&&"all"!=t?this.$nextTick((function(){this.hostForm.setFieldsValue({group:t})})):this.$nextTick((function(){this.hostForm.setFieldsValue({group:1})}))},onSubmit:function(){var e,t,a=this,s=new Promise((function(t,s){a.hostForm.validateFields((function(a,s){a||(e=s,t())}))})),r=new Promise((function(e,s){a.voucherForm.validateFields((function(a,s){a||(t=s,e())}))}));Promise.all([s,r]).then((function(s){a.btnLoading=!0;var r=e;"immediately"==a.addMethodType?(r.credential=t,r.credential.credential_type=a.verificationMethod):"have"==a.addMethodType&&("password"==a.credential_type?a.selectedpasswordList=a.targetKeys:"ssh"==a.credential_type?a.selectedsshList=a.targetKeys:"group"==a.credential_type&&(a.selectedgroupList=a.targetKeys),r.credential_list=a.selectedpasswordList.concat(a.selectedsshList),r.credential_group_list=a.selectedgroupList),r.resource_from="cmdb",r.host_name_code=a.selectedHost.name,Object(d["a"])(r).then((function(e){200==e.code&&(a.$message.success(e.message),a.onClose(),a.$emit("father"))})).finally((function(){a.btnLoading=!1}))}))}}}),R=F,q=(a("dc68"),Object(f["a"])(R,T,C,!1,null,"69acfb87",null)),N=q.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-modal",{attrs:{width:"1000px",visible:e.visible,title:"批量配置",confirmLoading:e.btnLoading},on:{cancel:e.onClose,ok:e.onSubmit}},[a("a-form",{attrs:{form:e.hostForm,"label-col":{span:2},"wrapper-col":{span:22}}},[a("a-form-item",{attrs:{label:"系统类型"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["system_type",{rules:[{required:!0,message:"请选择系统类型"}]}],expression:"['system_type', { rules: [{ required: true, message: '请选择系统类型' }] }]"}],attrs:{placeholder:"请选择系统类型"},on:{change:e.systemChange}},[a("a-select-option",{attrs:{value:"Windows"}},[e._v("Windows")]),a("a-select-option",{attrs:{value:"Linux"}},[e._v("Linux")])],1)],1),a("a-form-item",{attrs:{label:"协议类型"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["protocol_type",{rules:[{required:!0,message:"请选择协议类型"}]}],expression:"['protocol_type', { rules: [{ required: true, message: '请选择协议类型' }] }]"}],attrs:{placeholder:"请选择协议类型"}},[a("a-select-option",{attrs:{value:"SSH"}},[e._v("SSH")]),a("a-select-option",{attrs:{value:"RDP"}},[e._v("RDP")])],1)],1),a("a-form-item",{attrs:{label:"IP类型"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["ip_type",{rules:[{required:!0,message:"请选择IP类型"}]}],expression:"['ip_type', { rules: [{ required: true, message: '请选择IP类型' }] }]"}],staticStyle:{width:"320px"},attrs:{placeholder:"请选择IP类型"}},e._l(e.ipTypeList,(function(t,s){return a("a-select-option",{key:s,attrs:{value:t.code}},[e._v(" "+e._s(t.name)+" ")])})),1)],1),a("a-form-item",{attrs:{label:"端口"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["port",{rules:[{required:!0,message:"请输入1~65535之间的有效数字"}]}],expression:"['port', { rules: [{ required: true, message: '请输入1~65535之间的有效数字' }] }]"}],staticStyle:{width:"857px"},attrs:{min:1,max:65535,placeholder:"请输入1~65535之间的有效数字"}})],1),a("a-form-item",{attrs:{label:"所属分组"}},[a("a-tree-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["group",{rules:[{required:!0,message:"请选择所属分组"}]}],expression:"['group', { rules: [{ required: true, message: '请选择所属分组' }] }]"}],attrs:{"tree-data":e.fatherData,placeholder:"请选择分组"}})],1),a("a-form-item",{attrs:{label:"主机描述"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["description",{rules:[{required:!1},{max:200,message:"最多输入200个汉字或字符"}]}],expression:"['description', { rules: [{ required: false},{max:200,message:'最多输入200个汉字或字符'}] }]"}],attrs:{placeholder:"请输入，最多输入200个汉字或字符"}})],1),a("a-form-item",{attrs:{label:"添加凭证"}},[a("a-radio-group",{attrs:{"button-style":"solid"},model:{value:e.addMethodType,callback:function(t){e.addMethodType=t},expression:"addMethodType"}},[a("a-radio-button",{attrs:{value:"immediately"}},[e._v(" 立即添加 ")]),a("a-radio-button",{attrs:{value:"future"}},[e._v(" 以后添加 ")]),a("a-radio-button",{attrs:{value:"have"}},[e._v(" 选择已有 ")])],1)],1)],1),"immediately"==e.addMethodType?a("a-form",{attrs:{form:e.voucherForm,"label-col":{span:2},"wrapper-col":{span:22}}},[a("a-form-item",{attrs:{label:"登录方式"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["login_type",{initialValue:"auto",rules:[{required:!0,message:"请选择登录方式"}]}],expression:"['login_type', { initialValue: 'auto' ,rules: [{ required: true, message: '请选择登录方式' }] }]"}],on:{change:e.loginTypeChange}},[a("a-radio",{attrs:{value:"auto"}},[e._v(" 自动登录 ")]),a("a-radio",{attrs:{value:"hand"}},[e._v(" 手动登录 ")])],1)],1),a("a-form-item",{attrs:{label:"验证方式"}},[a("a-select",{model:{value:e.verificationMethod,callback:function(t){e.verificationMethod=t},expression:"verificationMethod"}},[a("a-select-option",{attrs:{value:"password"}},[e._v("密码凭证")]),a("a-select-option",{attrs:{value:"ssh_key"}},[e._v("SSH密钥")])],1)],1),a("a-form-item",{attrs:{label:"凭证名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入凭证名称"}]}],expression:"['name', { rules: [{ required: true, message: '请输入凭证名称' }] }]"}],attrs:{placeholder:"请输入凭证名称"}})],1),a("a-form-item",{attrs:{label:"资源账户"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["login_name",{rules:[{required:!0,message:"请输入资源账户"}]}],expression:"['login_name', { rules: [{ required:true, message: '请输入资源账户' }] }]"}],attrs:{autoComplete:"off",placeholder:"请输入资源账户的名称"}})],1),"password"==e.verificationMethod?a("div",["auto"==e.loginType?[a("a-form-item",{attrs:{label:"密码"}},[a("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["login_password",{rules:[{required:!0,message:"请输入密码"}]}],expression:"['login_password', { rules: [{ required: true, message: '请输入密码' }] }]"}],attrs:{autoComplete:"off",placeholder:"请输入密码"}})],1)]:e._e()],2):a("div",[a("a-form-item",{attrs:{label:"SSH key"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["ssh_key",{rules:[{required:!0,message:"请输入SSH key"}]}],expression:"['ssh_key', { rules: [{ required:true, message: '请输入SSH key' }] }]"}],attrs:{placeholder:"请输入SSH key",rows:4}})],1),"auto"==e.loginType?[a("a-form-item",{attrs:{label:"Passphrase"}},[a("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["passphrase",{rules:[{required:!1,message:"请输入Passphrase"}]}],expression:"['passphrase', { rules: [{ required: false, message: '请输入Passphrase' }] }]"}],attrs:{placeholder:"请输入Passphrase"}})],1)]:e._e()],2),a("a-form-item",{attrs:{label:"描述"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["description",{rules:[{required:!1},{max:200,message:"最多输入200个汉字或字符"}]}],expression:"['description', { rules: [{ required: false},{max:200,message:'最多输入200个汉字或字符'}] }]"}],attrs:{placeholder:"请输入，最多输入200个汉字或字符"}})],1)],1):e._e(),"have"==e.addMethodType?a("a-form",{attrs:{form:e.voucherForm,"label-col":{span:2},"wrapper-col":{span:22}}},[a("a-form-item",{attrs:{label:"添加凭证"}},[a("a-radio-group",{model:{value:e.credential_type,callback:function(t){e.credential_type=t},expression:"credential_type"}},[a("a-radio",{attrs:{value:"password"}},[e._v(" 密码凭证 ")]),a("a-radio",{attrs:{value:"ssh"}},[e._v(" SSH密钥 ")]),a("a-radio",{attrs:{value:"group"}},[e._v(" 凭证分组 ")])],1)],1),a("a-transfer",{staticStyle:{margin:"0 0 0 8.33%"},attrs:{operations:e.operations,titles:e.titles,"list-style":e.listStyle,dataSource:e.mockData,targetKeys:e.targetKeys,"show-search":"",render:e.transferRender},on:{change:e.handleChange}})],1):e._e()],1)],1)},I=[],K=(a("7db0"),a("5530")),E={data:function(){return{visible:!1,btnLoading:!1,hostForm:this.$form.createForm(this,{name:"hostForm"}),addMethodType:"immediately",voucherForm:this.$form.createForm(this,{name:"voucherForm"}),loginType:"auto",verificationMethod:"password",listStyle:{width:"360px",height:"420px"},titles:[],titles1:["可添加的密码凭据","已选择的密码凭据"],titles2:["可添加的SSH密钥","已选择的SSH密钥"],titles3:["可添加的凭据分组","已选择的凭据分组"],operations:["加入右侧","加入左侧"],mockData:[],targetKeys:[],credential_type:"password",allpasswordList:[],passwordList:[],selectedpasswordList:[],allsshList:[],sshList:[],selectedsshList:[],allgroupList:[],groupList:[],selectedgroupList:[],selectedRowKeys:{},ipList:[],ipTypeList:[{name:"内网IP",code:"内"},{name:"外网IP",code:"外"}],tableData:[]}},props:["fatherData","fatherTableData"],watch:{credential_type:{handler:function(e,t){"password"==t?this.selectedpasswordList=this.targetKeys:"ssh"==t?this.selectedsshList=this.targetKeys:"group"==t&&(this.selectedgroupList=this.targetKeys),"password"==e?(this.titles=this.titles1,this.mockData=this.passwordList,this.targetKeys=this.selectedpasswordList):"ssh"==e?(this.titles=this.titles2,this.mockData=this.sshList,this.targetKeys=this.selectedsshList):"group"==e&&(this.titles=this.titles3,this.mockData=this.groupList,this.targetKeys=this.selectedgroupList)}}},methods:{transferRender:function(e){var t,a=this.$createElement;return t="group"==this.credential_type?e.passwordNumber||e.sshNumber?a("span",{class:"custom-item"},[a("span",{style:"margin:0 10px 0 0"},[e.title]),a("span",["(",e.passwordNumber,"/",e.sshNumber,")"])]):a("span",{class:"custom-item"},[a("a-tooltip",{attrs:{placement:"top",title:"该分组没有关联密码凭证和SSH密钥,不可选择。"}},[a("span",{style:"margin:0 10px 0 0"},[e.title]),a("span",["(",e.passwordNumber,"/",e.sshNumber,")"])])]):a("span",{class:"custom-item"},[e.title]),{label:t,value:e.title}},onClose:function(){this.visible=!1,this.hostForm.resetFields(),this.targetKeys=[],this.voucherForm.resetFields(),this.selectedpasswordList=[],this.selectedsshList=[],this.selectedgroupList=[]},handleChange:function(e,t,a){this.targetKeys=e},loginTypeChange:function(e){this.loginType=e.target.value},getAllCredential:function(){var e=this;Object(u["d"])({all_data:"1",credential_type:"password"}).then((function(t){if(200==t.code&&t.data){var a=[];t.data.map((function(e){a.push({key:e.id+"",title:e.name})})),e.allpasswordList=a,e.passwordList=e.allpasswordList,e.mockData=e.passwordList}})),Object(u["d"])({all_data:"1",credential_type:"ssh_key"}).then((function(t){if(200==t.code&&t.data){var a=[];t.data.map((function(e){a.push({key:e.id+"",title:e.name})})),e.allsshList=a,e.sshList=e.allsshList}})),Object(c["d"])({all_data:"1"}).then((function(t){if(200==t.code&&t.data){var a=[];t.data.map((function(e){var t,s,r,o,i=(null===(t=e.credential)||void 0===t||null===(s=t.password_credential)||void 0===s?void 0:s.length)||0,n=(null===(r=e.credential)||void 0===r||null===(o=r.ssh_credential)||void 0===o?void 0:o.length)||0;a.push({key:e.id+"",title:e.name,passwordNumber:i,sshNumber:n,disabled:!i&&!n})})),e.allgroupList=a,e.groupList=e.allgroupList}}))},systemChange:function(e){"Windows"==e?this.hostForm.setFieldsValue({protocol_type:"RDP",port:3389}):"Linux"==e&&this.hostForm.setFieldsValue({protocol_type:"SSH",port:22})},show:function(e,t){this.selectedRowKeys=e,this.visible=!0,this.credential_type="password",this.getAllCredential(),this.titles=this.titles1,this.loginType="auto",this.addMethodType="immediately",this.tableData=this.fatherTableData.filter((function(t){return e.find((function(e){return e==t.key}))})),t&&"all"!=t?this.$nextTick((function(){this.hostForm.setFieldsValue({group:t})})):this.$nextTick((function(){this.hostForm.setFieldsValue({group:1})}))},onSubmit:function(){var e,t,a=this,s=new Promise((function(t,s){a.hostForm.validateFields((function(a,s){a||(e=s,t())}))})),r=new Promise((function(e,s){a.voucherForm.validateFields((function(a,s){a||(t=s,e())}))})),o=[];this.tableData.map((function(t){var a=Object(K["a"])({},e);"内"==e.ip_type?a.host_address=t.ip2:a.host_address=t.ip1,a.host_name=t.show_name,a.host_name_code=t.name,o.push(a)})),Promise.all([s,r]).then((function(e){a.btnLoading=!0;var s={import_type:"cmdb",data_list:o};"immediately"==a.addMethodType?(s.credential=t,s.credential.credential_type=a.verificationMethod):"have"==a.addMethodType&&("password"==a.credential_type?a.selectedpasswordList=a.targetKeys:"ssh"==a.credential_type?a.selectedsshList=a.targetKeys:"group"==a.credential_type&&(a.selectedgroupList=a.targetKeys),s.credential_list=a.selectedpasswordList.concat(a.selectedsshList),s.credential_group_list=a.selectedgroupList),Object(d["c"])(s).then((function(e){200==e.code&&(a.$message.success(e.message),a.onClose(),a.$emit("father"))})).finally((function(){a.btnLoading=!1}))}))}}},P=E,M=(a("17b2"),Object(f["a"])(P,O,I,!1,null,"e466b666",null)),j=M.exports,V={data:function(){return{visible:!1,tabKey:"SERVER",columns:[{title:"名称",dataIndex:"show_name"},{title:"公网IP地址",dataIndex:"ip1",scopedSlots:{customRender:"ip1"}},{title:"内网IP地址",dataIndex:"ip2",scopedSlots:{customRender:"ip2"}},{title:"操作系统",dataIndex:"opt_os",scopedSlots:{customRender:"opt_os"}},{title:"操作",width:120,scopedSlots:{customRender:"action"},align:"center"}],tableData:[],tableLoading:!1,searchList:[{name:"主机名称",key:"_VISIBLE_NAME"},{name:"公网IP",key:"_PUBLIC_IP"},{name:"内网IP",key:"_INTERNAL_IP"}],pagination:{total:0,current:1,pageSize:10,showTotal:function(e){return"共有 ".concat(e," 条数据")},search_type:"_VISIBLE_NAME",search_data:void 0},selectGroupId:void 0,number:{SERVER:0,VIRTUAL_SERVER:0,CLOUD_SERVER:0},selectedRowKeys:[]}},props:["fatherData"],methods:{show:function(e){this.visible=!0,this.selectGroupId=e,this.getAgentData()},onClose:function(){this.visible=!1,this.$emit("father"),this.selectedRowKeys=[]},tabsChange:function(e){this.tabKey=e,this.pagination.search_type="_VISIBLE_NAME",this.pagination.search_data=void 0,this.getAgentData(),this.selectedRowKeys=[]},getAgentData:function(){var e=this;this.tableLoading=!0;var t={};this.pagination.search_data&&(t.search_data=this.pagination.search_data,t.search_type=this.tabKey+this.pagination.search_type),H(t).then((function(t){200==t.code&&t.data?(e.number={SERVER:0,VIRTUAL_SERVER:0,CLOUD_SERVER:0},t.data.map((function(t){t.key=t.name,e.number[t.host_type]++})),e.allTableData=t.data,e.tableData=e.allTableData.filter((function(t){return t.host_type==e.tabKey}))):e.tableData=[]})).finally((function(){e.tableLoading=!1,e.selectedRowKeys=[]}))},searchTable:function(e){this.search_data=e,this.pagination.current=1,this.getAgentData()},onSelectChange:function(e){this.selectedRowKeys=e}},components:{AddHostFromCmdb:N,BatchAddition:j}},G=V,z=Object(f["a"])(G,S,D,!1,null,"d568d728",null),B=z.exports,$=a("6f7c"),Q={data:function(){return{treeData:[{key:"all",title:"全部主机",scopedSlots:{title:"action"},children:[]}],searchList:[{name:"主机名称",key:"host_name"},{name:"主机地址",key:"host_address"},{name:"系统类型",key:"system_type"}],selectedRowKeys:[],tableData:[],columns:[{title:"主机名称",dataIndex:"host_name",ellipsis:!0,scopedSlots:{customRender:"name"},width:200},{title:"主机地址",dataIndex:"host_address",ellipsis:!0},{title:"系统类型",dataIndex:"system_type",ellipsis:!0},{dataIndex:"voucher",ellipsis:!0,slots:{title:"voucherTitle"},scopedSlots:{customRender:"voucher"},width:150},{title:"创建时间",dataIndex:"create_time",ellipsis:!0},{title:"操作",width:200,scopedSlots:{customRender:"action"},align:"center"}],showTree:!1,fatherData:[],tableLoading:!1,pagination:{total:0,current:1,pageSize:10,showTotal:function(e){return"共有 ".concat(e," 条数据")},showSizeChanger:!0,showQuickJumper:!0,search_type:"host_name",search_data:void 0},selectGroupId:void 0,selectedKeys:["all"]}},mounted:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object($["a"])(e,"visit-host-resources");case 2:a=t.sent,a&&(e.getHostData(),e.getHostGroupData());case 4:case"end":return t.stop()}}),t)})))()},methods:{deleteHost:function(e){var t=this;this.$confirm({title:"确认删除该主机吗？",onOk:function(){Object(d["d"])({id:e.id}).then((function(e){200==e.code&&(t.$message.success(e.message),t.getHostData())}))}})},batchDelete:function(){var e=this;this.$confirm({title:"确认删除吗？",onOk:function(){Object(d["d"])({id_list:e.selectedRowKeys}).then((function(t){200==t.code&&(e.$message.success(t.message),e.getHostData(),e.selectedRowKeys=[])}))}})},treeSelect:function(e){this.selectGroupId=e[0],this.selectedKeys=e,this.pagination.current=1,this.getHostData()},onChange:function(e){this.pagination.total=e.total,this.pagination.current=e.current,this.pagination.pageSize=e.pageSize,this.getHostData()},onSelectChange:function(e){this.selectedRowKeys=e},getHostData:function(){var e=this;this.tableLoading=!0;var t={current:this.pagination.current,pageSize:this.pagination.pageSize};this.pagination.search_data&&(t.search_type=this.pagination.search_type,t.search_data=this.pagination.search_data),"all"!=this.selectGroupId&&(t.group_id=this.selectGroupId),Object(d["h"])(t).then((function(t){200==t.code&&t.data&&(e.pagination.total=t.data.total,e.pagination.current=t.data.current,e.pagination.pageSize=t.data.pageSize,t.data.data.map((function(e){e.key=e.id,e.voucher=(e.credential.password_credential?e.credential.password_credential.length:"0")+"/"+(e.credential.ssh_credential?e.credential.ssh_credential.length:"0")+"/"+(e.credential.credential_group?e.credential.credential_group.length:"0")})),e.tableData=t.data.data)})).finally((function(){e.tableLoading=!1}))},searchTable:function(e){this.search_data=e,this.pagination.current=1,this.getHostData()},refresh:function(){this.pagination=this.$options.data().pagination,this.getHostData()},getHostGroupData:function(){var e=this;this.showTree=!1,Object(d["i"])().then((function(t){function a(e,t){e.map((function(e){e.key=e.id,e.title=e.name,e.scopedSlots={title:"action"},e.layer=t,e.value=e.id,e.children&&e.children.length>0&&a(e.children,t+1)}))}200==t.code&&t.data&&(a(t.data,2),e.treeData[0].children=t.data,e.fatherData=t.data)})).finally((function(){e.showTree=!0}))},deleteGroup:function(e){var t=this;this.$confirm({title:"确认删除该分组吗?",onOk:function(){Object(d["e"])({id:e.id}).then((function(a){200==a.code?(t.$message.success(a.message),e.id==t.selectGroupId&&(t.selectedKeys=["all"],t.selectGroupId="all"),t.getHostGroupData(),t.getHostData()):t.$message.error(a.message)}))}})},handleLogin:function(e){this.$refs.LoginHostModal.showModal(e)}},components:{ContentHeader:i["a"],AddHost:v,AddGroup:x,LoginHostModal:y["a"],AddFromCmdb:B}},J=Q,U=(a("516d"),Object(f["a"])(J,s,r,!1,null,"ae8cc7ba",null));t["default"]=U.exports},"516d":function(e,t,a){"use strict";var s=a("b476"),r=a.n(s);r.a},"51a4":function(e,t,a){},"6bdf":function(e,t,a){"use strict";var s=a("a0f5"),r=a.n(s);r.a},"6f7c":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("d3b7");var s=a("a18c"),r=a("b775"),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["b"])({url:"authentication/",method:"get",params:e})},i=function(){s["a"].push({name:"noAuth"})},n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new Promise((function(a,s){setTimeout((function(){e.$loading.show()}),0),o({action_id:t}).then((function(e){return e.data||i(),a(e.data)})).catch((function(){return i(),a(!1)})).finally((function(){setTimeout((function(){e.$loading.hide()}),0)}))}))}},a0f5:function(e,t,a){},b476:function(e,t,a){},bf96a:function(e,t,a){},cb20:function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return n}));var s=a("b775"),r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"credential/",method:"get",params:e})},o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"credential/",method:"post",data:e})},i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"credential/",method:"put",data:e})},n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"credential/",method:"delete",data:e})}},ce17:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("a-modal",{attrs:{closable:!1,bodyStyle:{padding:0},width:"650px",confirmLoading:e.loading},on:{ok:e.handleOk,cancel:e.handleCancel},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[s("div",{staticClass:"header"},[s("div",{staticClass:"header_left"},[s("div",[s("img",{attrs:{src:a("f2fd"),alt:""}})])]),s("div",{staticClass:"header_right"},[s("strong",[e._v(e._s(e.hostInfo.host_name))]),s("div",[e._v("主机地址："+e._s(e.hostInfo.host_address||"-"))]),s("div",[e._v("协议类型："+e._s(e.hostInfo.protocol_type||"-"))]),s("div",[e._v("端口："+e._s(e.hostInfo.port||"-"))])])]),s("a-spin",{attrs:{spinning:e.infoLoading}},[s("div",{staticClass:"content"},[s("a-form-model",{ref:"formData",attrs:{layout:"horizontal",model:e.formData,rules:e.formDataRules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[s("a-form-model-item",{attrs:{label:"资源凭证",prop:"credential_host_id"}},[s("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择资源凭证"},on:{change:e.changeCredential},model:{value:e.formData.credential_host_id,callback:function(t){e.$set(e.formData,"credential_host_id",t)},expression:"formData.credential_host_id"}},e._l(e.credentialList,(function(t){return s("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.login_name)+"/"+e._s(t.host_address)+"("+e._s(t.credential_name)+") ")])})),1)],1),e.isHand?s("a-form-model-item",{attrs:{label:"密码"}},[s("a-input-password",{attrs:{placeholder:"请输入密码"},model:{value:e.formData.password,callback:function(t){e.$set(e.formData,"password",t)},expression:"formData.password"}})],1):e._e(),"Windows"!=e.hostInfo.system_type?s("a-form-model-item",{attrs:{label:"字体大小"}},[s("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入字体大小",min:14,max:20,allowClear:""},model:{value:e.formData.font_size,callback:function(t){e.$set(e.formData,"font_size",t)},expression:"formData.font_size"}})],1):e._e(),"Windows"==e.hostInfo.system_type?s("a-form-model-item",{attrs:{label:"分辨率"}},[s("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择分辨率",allowClear:""},on:{change:e.changeCredential},model:{value:e.formData.winSize,callback:function(t){e.$set(e.formData,"winSize",t)},expression:"formData.winSize"}},e._l(e.screenArr,(function(t){return s("a-select-option",{key:t.key,attrs:{value:t.key}},[e._v(" "+e._s(t.width)+" * "+e._s(t.height)+" ")])})),1)],1):e._e()],1)],1)])],1)],1)},r=[],o=(a("99af"),a("7db0"),a("d3b7"),a("ac1f"),a("5319"),a("5412")),i=a("e6c6"),n=a("ca00"),l=a("0c00"),d=a("cd3f"),c=a.n(d),u={data:function(){return{visible:!1,infoLoading:!1,loading:!1,hostInfo:{},formData:{host_id:void 0,credential_host_id:void 0,password:void 0,width:void 0,height:void 0,font_size:14,winSize:8},formDataRules:{credential_host_id:[{required:!0,message:"请选择资源凭证",trigger:"change"}]},labelCol:{span:4},wrapperCol:{span:20},credentialList:[],isHand:!1,screenArr:l["a"],localOpen:!1,linkType:"host"}},methods:{showModal:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"host";this.linkType=s,this.localOpen=a,this.hostInfo=c()(e),this.formData=this.$options.data().formData,this.$nextTick((function(){var e;null===(e=t.$refs.formData)||void 0===e||e.clearValidate()})),this.isHand=!1,this.getResourceCredential(),this.visible=!0},getResourceCredential:function(){var e=this;this.infoLoading=!0;var t={host_id:this.hostInfo.id,data_type:"host"};Object(o["a"])(t).then((function(t){if(e.credentialList=t.data,t.data.length>0){e.formData.credential_host_id=t.data[0].id;var a="hand"==t.data[0].login_type;e.isHand=a}})).finally((function(){e.infoLoading=!1}))},changeCredential:function(e){var t=this.credentialList.find((function(t){return t.id==e}))||{},a="hand"==t.login_type;a!=this.isHand&&(this.formData.password=void 0),this.isHand=a},handleOk:function(){var e=this;this.$refs.formData.validate((function(t){t&&(e.loading=!0,e.formData.host_id=e.hostInfo.id,Object(i["b"])(e.formData).then((function(t){window.API_ROOT.replace("/bastion/","");var a=!1,s="Windows"==e.hostInfo.system_type?"webWindows":"remoteLinux",r={host_token:t.data,fontSize:e.formData.font_size,linkType:e.linkType};if("webWindows"==s&&(delete r.fontSize,e.formData.winSize&&(r.winSize=e.formData.winSize)),e.localOpen)return e.visible=!1,e.$emit("getHostToken",r,e.hostInfo);var o=a?"".concat(window.location.origin,"/#/console/").concat(s).concat(Object(n["b"])(r)):"".concat(window.location.origin).concat(window.location.pathname,"#/console/").concat(s).concat(Object(n["b"])(r));window.open(o),e.visible=!1})).finally((function(){e.loading=!1})))}))},handleCancel:function(){this.visible=!1}},mounted:function(){}},h=u,p=(a("6bdf"),a("2877")),m=Object(p["a"])(h,s,r,!1,null,"14dcb65f",null);t["a"]=m.exports},dc68:function(e,t,a){"use strict";var s=a("2b08"),r=a.n(s);r.a},e6c6:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return o}));var s=a("b775"),r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"link-check-v2/",method:"post",data:e})},o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"link-check-v2/",method:"get",params:e})}},f2fd:function(e,t){e.exports="data:image/png;base64,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"}}]);