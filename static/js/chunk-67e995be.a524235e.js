(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-67e995be"],{4246:function(t,e,a){"use strict";a.d(e,"g",(function(){return s})),a.d(e,"a",(function(){return i})),a.d(e,"e",(function(){return o})),a.d(e,"c",(function(){return r})),a.d(e,"h",(function(){return l})),a.d(e,"b",(function(){return c})),a.d(e,"f",(function(){return d})),a.d(e,"d",(function(){return u})),a.d(e,"j",(function(){return h})),a.d(e,"i",(function(){return p}));var n=a("b775"),s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"host/",method:"get",params:t})},i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"host/",method:"post",data:t})},o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"host/",method:"put",data:t})},r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"host/",method:"delete",data:t})},l=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"host-group/",method:"get",params:t})},c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"host-group/",method:"post",data:t})},d=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"host-group/",method:"put",data:t})},u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"host-group/",method:"delete",data:t})},h=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"host-credential/",method:"delete",data:t})},p=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"auth-host/",method:"get",params:t})}},"523f":function(t,e,a){},"8a93":function(t,e,a){"use strict";var n=a("523f"),s=a.n(n);s.a},"8e7c":function(t,e,a){"use strict";var n=a("e098"),s=a.n(n);s.a},cb20:function(t,e,a){"use strict";a.d(e,"d",(function(){return s})),a.d(e,"a",(function(){return i})),a.d(e,"c",(function(){return o})),a.d(e,"b",(function(){return r}));var n=a("b775"),s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"credential/",method:"get",params:t})},i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"credential/",method:"post",data:t})},o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"credential/",method:"put",data:t})},r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"credential/",method:"delete",data:t})}},e05b:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"password_main"},[a("ContentHeader",[a("div",{attrs:{slot:"docs"},slot:"docs"},[t._v(" 密码凭证支持自动登录和手工登录，手工登录在登录时，需要用户手工输入密码。一个密码凭证支持关联多个主机资源和应用资源。 ")])]),a("a-card",[a("div",{staticClass:"search_box"},[a("a-input-search",{staticStyle:{width:"200px"},attrs:{allowClear:"",placeholder:"请输入搜索名称"},on:{search:t.onSearch}}),t.$store.state.btnAuth.btnAuth.bastion_password_create?a("a-button",{staticStyle:{float:"right"},attrs:{icon:"plus",type:"primary"},on:{click:function(e){return t.$refs.AddPassword.show()}}},[t._v("新建")]):t._e()],1),a("a-table",{attrs:{loading:t.tableLoading,pagination:t.pagination,"row-selection":{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange},columns:t.columns,"data-source":t.tableData},on:{change:t.onChange},scopedSlots:t._u([{key:"name",fn:function(e,n){return[t.$store.state.btnAuth.btnAuth.bastion_password_details?a("a",{attrs:{title:e},on:{click:function(e){return t.$router.push({path:"/voucher/password/passwordDetails",query:{id:n.id}})}}},[t._v(t._s(e))]):a("span",{attrs:{title:e}},[t._v(t._s(e))])]}},{key:"login_type",fn:function(e){return[t._v(" "+t._s("auto"==e?"自动登录":"手动登录")+" ")]}},{key:"relation",fn:function(e,n){return[t.$store.state.btnAuth.btnAuth.bastion_password_details?a("a",{on:{click:function(e){return t.$router.push({path:"/voucher/password/passwordDetails",query:{id:n.id}})}}},[t._v(t._s(e))]):a("span",[t._v(t._s(e))])]}},{key:"description",fn:function(e){return[t._v(" "+t._s(e||"--")+" ")]}},{key:"action",fn:function(e,n){return[t.$store.state.btnAuth.btnAuth.bastion_password_details?a("a-button",{attrs:{size:"small",type:"link"},on:{click:function(e){return t.$router.push({path:"/voucher/password/passwordDetails",query:{id:n.id}})}}},[t._v("查看")]):t._e(),t.$store.state.btnAuth.btnAuth.bastion_password_update?a("a-button",{attrs:{size:"small",type:"link"},on:{click:function(e){return t.$refs.AddPassword.show(n)}}},[t._v("编辑")]):t._e(),t.$store.state.btnAuth.btnAuth.bastion_password_delete?a("a-button",{staticStyle:{color:"#333"},attrs:{size:"small",type:"link"},on:{click:function(e){return t.deletePassword(n)}}},[t._v("删除")]):t._e()]}}])}),t.tableData.length>0?a("a-button",{staticStyle:{float:"left",margin:"-50px 10px 0 0"},attrs:{disabled:0==t.selectedRowKeys.length,icon:"delete"},on:{click:t.batchDelete}},[t._v("批量删除")]):t._e()],1),a("AddPassword",{ref:"AddPassword",on:{father:function(e){return t.getCredentialData()}}})],1)},s=[],i=(a("4de4"),a("d3b7"),a("0977")),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-drawer",{attrs:{"body-style":{paddingBottom:"80px"},width:"980px",title:t.title,placement:"right",visible:t.visible},on:{close:t.onClose}},[a("a-form",{attrs:{form:t.passwordForm,"label-col":{span:2},"wrapper-col":{span:22}}},[a("a-form-item",{attrs:{label:"凭证名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入凭证名称"}]}],expression:"['name', { rules: [{ required: true, message: '请输入凭证名称' }] }]"}],attrs:{placeholder:"请输入凭证名称"}})],1),a("a-form-item",{attrs:{label:"登录方式"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["login_type",{initialValue:"auto",rules:[{required:!0,message:"请选择登录方式"}]}],expression:"['login_type', { initialValue: 'auto' ,rules: [{ required: true, message: '请选择登录方式' }] }]"}],on:{change:t.loginTypeChange}},[a("a-radio",{attrs:{value:"auto"}},[t._v(" 自动登录 ")]),a("a-radio",{attrs:{value:"hand"}},[t._v(" 手动登录 ")])],1)],1),a("a-form-item",{attrs:{label:"资源账户"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["login_name",{rules:[{required:!0,message:"请输入资源账户"}]}],expression:"['login_name', { rules: [{ required: true , message: '请输入资源账户' }] }]"}],attrs:{placeholder:"请输入资源账户的名称"}})],1),"auto"==t.loginType?[a("a-form-item",{attrs:{label:"密码"}},[a("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["login_password",{rules:[{required:!0,message:"请输入密码"}]}],expression:"['login_password', { rules: [{ required: true, message: '请输入密码' }] }]"}],attrs:{placeholder:"请输入密码"}})],1)]:t._e(),a("a-form-item",{attrs:{label:"描述"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["description",{rules:[{required:!1},{max:200,message:"最多输入200个汉字或字符"}]}],expression:"['description', { rules: [{ required: false},{max:200,message:'最多输入200个汉字或字符'}] }]"}],attrs:{placeholder:"请输入，最多输入200个汉字或字符"}})],1),a("a-form-item",{attrs:{label:"关联资源"}},[a("a-radio-group",{attrs:{"button-style":"solid"},on:{change:t.resourcesTypeChange},model:{value:t.resources_type,callback:function(e){t.resources_type=e},expression:"resources_type"}},[a("a-radio-button",{attrs:{value:"host"}},[t._v(" 主机资源 ")])],1)],1),a("a-transfer",{staticStyle:{margin:"0 0 0 8.33%"},attrs:{operations:t.operations,titles:t.titles,"list-style":t.listStyle,dataSource:t.mockData,targetKeys:t.targetKeys,"show-search":"",render:function(t){return t.title}},on:{change:t.handleChange}})],2),a("footer",[a("a-button",{on:{click:t.onClose}},[t._v("取消")]),a("a-button",{staticStyle:{margin:"0 0px 0 8px"},attrs:{loading:t.btnLoading,type:"primary"},on:{click:t.onSubmit}},[t._v("保存")])],1)],1)],1)},r=[],l=(a("a4d3"),a("e01a"),a("d81d"),a("b0c0"),a("cb20")),c=a("4246"),d={data:function(){return{title:"",visible:!1,passwordForm:this.$form.createForm(this,{name:"passwordForm"}),mockData:[],targetKeys:[],isEdit:!1,btnLoading:!1,loginType:"auto",resources_type:"host",allhostList:[],hostList:[],selectedhostList:[],allappList:[],appList:[],selectedappList:[],listStyle:{width:"360px",height:"420px"},titles:["可选中的主机资源","已选择的主机资源"],operations:["加入右侧","加入左侧"]}},mounted:function(){},methods:{resourcesTypeChange:function(){},getAllHost:function(){var t=this;Object(c["g"])({all_data:1}).then((function(e){if(200==e.code&&e.data){var a=[];e.data.map((function(t){a.push({key:t.id+"",title:t.host_name})})),t.allhostList=a,t.hostList=t.allhostList,t.mockData=t.hostList}}))},loginTypeChange:function(t){this.loginType=t.target.value},show:function(t){if(this.visible=!0,this.getAllHost(),t){this.activePassword=t,this.isEdit=!0,this.title="编辑密码凭证",this.loginType=t.login_type;var e=[];t.host_list.map((function(t){e.push(t.id+"")})),this.selectedhostList=e,this.targetKeys=this.selectedhostList,this.$nextTick((function(){this.passwordForm.setFieldsValue({name:t.name,login_type:t.login_type,login_name:t.login_name,login_password:"******",description:t.description})}))}else this.isEdit=!1,this.title="新建密码凭证",this.loginType="auto"},onClose:function(){this.visible=!1,this.passwordForm.resetFields(),this.$emit("father"),this.targetKeys=[],this.selectedhostList=[],this.selectedappList=[]},handleChange:function(t,e,a){this.targetKeys=t},onSubmit:function(){var t=this;this.passwordForm.validateFields((function(e,a){if(!e){t.btnLoading=!0;var n=a;n.credential_type="password","host"==t.resources_type?t.selectedhostList=t.targetKeys:t.selectedappList=t.targetKeys,n.host_list=t.selectedhostList,t.isEdit?(n.id=t.activePassword.id,Object(l["c"])(n).then((function(e){200==e.code&&(t.$message.success(e.message),t.onClose())})).finally((function(){t.btnLoading=!1}))):Object(l["a"])(n).then((function(e){200==e.code&&(t.$message.success(e.message),t.onClose())})).finally((function(){t.btnLoading=!1}))}}))}}},u=d,h=(a("8a93"),a("2877")),p=Object(h["a"])(u,o,r,!1,null,"5381b1ac",null),g=p.exports,f={data:function(){return{tableData:[],columns:[{title:"凭证名称",dataIndex:"name",ellipsis:!0,scopedSlots:{customRender:"name"}},{title:"资源账户",dataIndex:"login_name",ellipsis:!0},{title:"登录方式",dataIndex:"login_type",ellipsis:!0,scopedSlots:{customRender:"login_type"}},{title:"关联主机",dataIndex:"relation",ellipsis:!0,scopedSlots:{customRender:"relation"}},{title:"描述",dataIndex:"description",ellipsis:!0,scopedSlots:{customRender:"description"}},{title:"操作",scopedSlots:{customRender:"action"},align:"center",width:200}],selectedRowKeys:[],pagination:{total:0,current:1,pageSize:10,showTotal:function(t){return"共有 ".concat(t," 条数据")},search_type:"name",search_data:void 0,showSizeChanger:!0,showQuickJumper:!0},tableLoading:!1}},mounted:function(){this.getCredentialData()},methods:{onSearch:function(t){this.pagination.search_data=t,this.pagination.current=1,this.getCredentialData()},onChange:function(t){this.pagination.total=t.total,this.pagination.current=t.current,this.pagination.pageSize=t.pageSize,this.getCredentialData()},batchDelete:function(){var t=this;this.$confirm({title:"确认删除吗？",onOk:function(){Object(l["b"])({id_list:t.selectedRowKeys}).then((function(e){200==e.code&&(t.$message.success(e.message),t.getCredentialData(),t.selectedRowKeys=[])}))}})},deletePassword:function(t){var e=this;this.$confirm({title:"确认删除该密码凭证吗？",onOk:function(){Object(l["b"])({id:t.id}).then((function(t){200==t.code&&(e.$message.success(t.message),e.getCredentialData())}))}})},onSelectChange:function(t){this.selectedRowKeys=t},getCredentialData:function(){var t=this;this.tableLoading=!0;var e={current:this.pagination.current,pageSize:this.pagination.pageSize,credential_type:"password"};this.pagination.search_data&&(e.search_type="name",e.search_data=this.pagination.search_data),Object(l["d"])(e).then((function(e){if(200==e.code&&e.data){t.pagination.total=e.data.total,t.pagination.current=e.data.current,t.pagination.pageSize=e.data.pageSize;var a=e.data.data.filter((function(t){return t.key=t.id,t.relation=t.host_list.length,"password"==t.credential_type}));t.tableData=a}else t.tableData=[]})).finally((function(){t.tableLoading=!1}))}},components:{ContentHeader:i["a"],AddPassword:g}},m=f,b=(a("8e7c"),Object(h["a"])(m,n,s,!1,null,"27d63715",null));e["default"]=b.exports},e098:function(t,e,a){}}]);